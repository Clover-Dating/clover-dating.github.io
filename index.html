<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clover &middot; Coming Soon</title>
  <meta name="description" content="Clover is a humane dating app focused on compatibility, without ads or swiping. Sign up to get notified when we launch.">

  <!-- Open Graph / Social -->
  <meta property="og:title" content="Clover - Coming Soon">
  <meta property="og:description" content="A humane dating app focused on compatibility, without ads or swiping. Sign up to get notified when we launch.">
  <meta property="og:image" content="banner.png">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png">
  <link rel="icon" type="image/png" sizes="64x64" href="favicon-64.png">
  <link rel="icon" type="image/png" sizes="128x128" href="favicon-128.png">
  <link rel="icon" type="image/png" sizes="256x256" href="favicon-256.png">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="apple-touch-icon" sizes="256x256" href="favicon-256.png">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Jersey+10&display=swap" rel="stylesheet">

  <style>
    :root {
      /* Light theme */
      --bg: #F5F0EB;
      --surface: #FFFFFF;
      --text: #1A1A1A;
      --text-secondary: #524D48;
      --border: #2A2A2A;
      --border-light: #D1CBC4;
      --primary: #62a94c;
      --primary-hover: #4e8a3d;
      --error: #B83232;
      --input-bg: #FFFFFF;
      --hover-bg: #E8E2DC;
      --placeholder: #A8A29C;
    }

    [data-theme="dark"] {
      --bg: #1A1612;
      --surface: #26221E;
      --text: #F5F0EB;
      --text-secondary: #CDC8C2;
      --border: #3D3530;
      --border-light: #2D2824;
      --primary: #62a94c;
      --primary-hover: #4e8a3d;
      --error: #D44444;
      --input-bg: #2D2824;
      --hover-bg: #352F2A;
      --placeholder: #6A6560;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 48px 24px 1em;
      transition: background-color 0.2s, color 0.2s;
    }

    .theme-toggle {
      position: fixed;
      top: 12px;
      right: 12px;
      background: var(--bg);
      border: none;
      width: 45px;
      height: 45px;
      padding: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      border-radius: 50%;
      transition: background-color 0.2s;
    }

    .theme-toggle img {
      width: 24px;
      height: 24px;
      image-rendering: pixelated;
    }

    .theme-toggle .sun { display: none; }
    .theme-toggle .moon { display: block; }
    [data-theme="dark"] .theme-toggle .sun { display: block; }
    [data-theme="dark"] .theme-toggle .moon { display: none; }

    .container {
      max-width: 600px;
      width: 100%;
      text-align: center;
    }

    .logo {
      width: 228px;
      height: auto;
      margin-bottom: 32px;
      image-rendering: pixelated;
    }

    h1 {
      font-family: 'Jersey 10', sans-serif;
      font-size: 64px;
      font-weight: 400;
      margin-bottom: 16px;
      letter-spacing: 1px;
    }

    .tagline {
      font-size: 18px;
      color: var(--text-secondary);
      margin-bottom: 32px;
      line-height: 1.5;
    }

    .body-text {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 32px;
      line-height: 1.6;
      text-align: justify;
    }

    .body-text p {
      margin-bottom: 16px;
    }

    .body-text p:last-child {
      margin-bottom: 0;
    }

    .coming-soon {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      font-family: 'Jersey 10', sans-serif;
      color: var(--text-secondary);
      font-size: 28px;
      margin-bottom: 40px;
    }

    .coming-soon img {
      width: 24px;
      height: 24px;
      image-rendering: pixelated;
    }

    .rocket {
      position: relative;
      width: 24px;
      height: 24px;
      display: inline-block;
    }

    .rocket img {
      position: absolute;
      top: 0;
      left: 0;
    }

    .coming-soon .rocket-dark { display: block; }
    .coming-soon .rocket-light { display: none; }
    [data-theme="dark"] .coming-soon .rocket-dark { display: none; }
    [data-theme="dark"] .coming-soon .rocket-light { display: block; }

    .rocket .frame1 { animation: rocketFrame 1s step-end infinite; }
    .rocket .frame2 { opacity: 0; animation: rocketFrame 1s step-end infinite 0.5s; }

    @keyframes rocketFrame {
      0%, 50% { opacity: 1; }
      50.01%, 100% { opacity: 0; }
    }

    .signup-form {
      margin-bottom: 32px;
    }

    .signup-form form {
      display: inline-flex;
      gap: 12px;
    }

    .signup-form input[type="email"] {
      width: 250px;
      padding: 12px 16px;
      font-family: 'Jersey 10', sans-serif;
      font-size: 28px;
      border: none;
      background: var(--input-bg);
      color: var(--text-secondary);
      transition: background-color 0.2s;
      clip-path: polygon(
        4px 0, calc(100% - 4px) 0,
        calc(100% - 4px) 4px, 100% 4px,
        100% calc(100% - 4px), calc(100% - 4px) calc(100% - 4px),
        calc(100% - 4px) 100%, 4px 100%,
        4px calc(100% - 4px), 0 calc(100% - 4px),
        0 4px, 4px 4px
      );
    }

    .signup-form input[type="email"]::placeholder {
      color: var(--placeholder);
    }

    .signup-form input[type="email"]:focus {
      outline: none;
    }

    .input-wrapper {
      position: relative;
      display: inline-flex;
    }

    .input-wrapper::before {
      content: '';
      position: absolute;
      top: -4px;
      left: -4px;
      right: -4px;
      bottom: -4px;
      background: var(--primary);
      clip-path: polygon(
        8px 0, calc(100% - 8px) 0,
        calc(100% - 8px) 4px, calc(100% - 4px) 4px,
        calc(100% - 4px) 8px, 100% 8px,
        100% calc(100% - 8px), calc(100% - 4px) calc(100% - 8px),
        calc(100% - 4px) calc(100% - 4px), calc(100% - 8px) calc(100% - 4px),
        calc(100% - 8px) 100%, 8px 100%,
        8px calc(100% - 4px), 4px calc(100% - 4px),
        4px calc(100% - 8px), 0 calc(100% - 8px),
        0 8px, 4px 8px,
        4px 4px, 8px 4px
      );
      opacity: 0;
      transition: opacity 0.15s;
      pointer-events: none;
    }

    .input-wrapper:hover::before {
      opacity: 0.4;
    }

    .input-wrapper:focus-within::before {
      opacity: 1;
    }

    .signup-form button {
      font-family: 'Jersey 10', sans-serif;
      padding: 12px 28px;
      font-size: 28px;
      background-color: var(--primary);
      color: white;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s;
      clip-path: polygon(
        4px 0, calc(100% - 4px) 0,
        calc(100% - 4px) 4px, 100% 4px,
        100% calc(100% - 4px), calc(100% - 4px) calc(100% - 4px),
        calc(100% - 4px) 100%, 4px 100%,
        4px calc(100% - 4px), 0 calc(100% - 4px),
        0 4px, 4px 4px
      );
    }

    .button-wrapper {
      position: relative;
      display: inline-flex;
    }

    .button-wrapper::before {
      content: '';
      position: absolute;
      top: -4px;
      left: -4px;
      right: -4px;
      bottom: -4px;
      background: var(--primary);
      clip-path: polygon(
        8px 0, calc(100% - 8px) 0,
        calc(100% - 8px) 4px, calc(100% - 4px) 4px,
        calc(100% - 4px) 8px, 100% 8px,
        100% calc(100% - 8px), calc(100% - 4px) calc(100% - 8px),
        calc(100% - 4px) calc(100% - 4px), calc(100% - 8px) calc(100% - 4px),
        calc(100% - 8px) 100%, 8px 100%,
        8px calc(100% - 4px), 4px calc(100% - 4px),
        4px calc(100% - 8px), 0 calc(100% - 8px),
        0 8px, 4px 8px,
        4px 4px, 8px 4px
      );
      opacity: 0;
      transition: opacity 0.15s;
      pointer-events: none;
    }

    .button-wrapper:hover::before {
      background: #111111;
      opacity: 0.6;
    }

    .button-wrapper:focus-within::before,
    .button-wrapper:active::before {
      background: var(--text-secondary);
      opacity: 1;
    }

    [data-theme="dark"] .button-wrapper:hover::before {
      background: #ffffff;
      opacity: .75;
    }

    [data-theme="dark"] .button-wrapper:focus-within::before,
    [data-theme="dark"] .button-wrapper:active::before {
      background: #ffffff;
      opacity: 1;
    }

    .signup-label {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }

    .social-links {
      position: fixed;
      top: 16px;
      left: 16px;
      z-index: 10;
    }

    .social-bubble {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 10px 14px;
      background: var(--bg);
      border-radius: 999px;
      transition: background-color 0.2s;
    }

    .social-icon {
      color: var(--text-secondary);
      text-decoration: none;
      display: flex;
      transition: opacity 0.15s;
    }

    .social-icon:hover {
      opacity: 0.7;
    }

    .twitter-icon,
    .github-icon {
      width: 24px;
      height: 24px;
    }

    .donate-button {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-family: 'Jersey 10', sans-serif;
      font-size: 28px;
      padding: 12px 28px;
      background-color: var(--primary);
      color: white;
      text-decoration: none;
      cursor: pointer;
      transition: background-color 0.2s;
      clip-path: polygon(
        4px 0, calc(100% - 4px) 0,
        calc(100% - 4px) 4px, 100% 4px,
        100% calc(100% - 4px), calc(100% - 4px) calc(100% - 4px),
        calc(100% - 4px) 100%, 4px 100%,
        4px calc(100% - 4px), 0 calc(100% - 4px),
        0 4px, 4px 4px
      );
    }

    .heart-icon {
      width: 24px;
      height: 24px;
      image-rendering: pixelated;
    }

    .footer {
      margin-top: auto;
      padding: 48px 0 14px;
      font-size: 13px;
      color: var(--text-secondary);
      letter-spacing: 0.5px;
    }

    .footer a {
      color: var(--text-secondary);
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }

    .fleuron {
      margin-bottom: 18px;
    }
    .fleuron img {
      height: 24px;
      width: auto;
      image-rendering: pixelated;
    }
    .fleuron .fleuron-light { display: block; margin: 0 auto; }
    .fleuron .fleuron-dark { display: none; }
    [data-theme="dark"] .fleuron .fleuron-light { display: none; }
    [data-theme="dark"] .fleuron .fleuron-dark { display: block; margin: 0 auto; }

    @media (max-width: 480px) {
      h1 {
        font-size: 48px;
      }

      .tagline {
        font-size: 16px;
      }

      .signup-form form {
        flex-direction: column;
        width: 100%;
      }

      .signup-form input[type="email"],
      .signup-form button {
        width: 100%;
      }

      .theme-toggle {
        top: 12px;
        right: 12px;
      }

      }
  </style>
  <!-- Givebutter -->
  <script async src="https://widgets.givebutter.com/latest.umd.cjs?acct=BvuKzDTxe9pSXSMR&p=other"></script>
  <!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "0db9f099e49c488eaca767a6ce19a02b"}'></script><!-- End Cloudflare Web Analytics -->
</head>
<body>
  <button class="theme-toggle" aria-label="Toggle dark mode">
    <img class="sun" src="sun.png" alt="Light mode">
    <img class="moon" src="moon.png" alt="Dark mode">
  </button>

  <div class="container">
    <canvas id="logo-canvas" class="logo" width="228" height="212" role="img" aria-label="Clover logo"></canvas>

    <p class="tagline">
      <!-- Dating without games or swiping. Deep compatibility matching for people who remember when dating apps actually worked. -->
      <!-- Deep compatibility matching. No swiping.<br/>Like the best dating apps were—before they sold out. -->
      <!-- Dating without games or swiping. Deep compatibility matching—like the best dating apps, before they sold out. -->
      Humane online dating. Deep compatibility matching without the swiping, ads, or tricks.
    </p>

    <div class="coming-soon"><span class="rocket"><img class="rocket-dark frame1" src="rocket-dark.png" alt=""><img class="rocket-dark frame2" src="rocket-dark-2.png" alt=""><img class="rocket-light frame1" src="rocket-light.png" alt=""><img class="rocket-light frame2" src="rocket-light-2.png" alt=""></span>Coming soon</div>

    <div class="signup-form">
      <form id="signup-form">
        <span class="input-wrapper"><input type="email" id="email" placeholder="your@email.com" required></span>
        <span class="button-wrapper"><button type="submit">Join the waitlist</button></span>
      </form>
      <p id="form-message" style="margin-top: 12px; font-size: 14px;">&nbsp;</p>
    </div>

    <div class="body-text">
      <p>The year is 2026 and the online dating scene is in shambles. All the most popular apps are highly extractive and anyone who uses them is certainly "braving it out there".</p>
      <p>It seems time to do something about it. Clover is a labor of love inspired by what the best dating apps used to be. It is built entirely for the benefit of its users and is offered as a gift to the commons, funded by donations and kept as affordable as possible. It features honest design and deep compatibility matching through match questions.</p>
      <p>Clover has no perverse incentives, no feature gatekeeping, no ads, no gamification, no stringing you along to keep you swiping. We believe that technology has unbelievable potential to help people find each other, and that the current state of the most popular dating apps—especially the swiping paradigm—reflects a gross misuse of technology. In that spirit, our aim is to find you your best match, period.</p>
      <p><strong>We're funding Clover through donations with the goal of keeping it free and open.</strong> Right now we're aiming to raise enough money to cover development, marketing, and our first year of operations.  If donation funding isn't sustainable long-term, we'll introduce a minimal subscription model ($3–5/month) with ways to earn free access. Either way: no VCs, no investors, no compromises.</p>
      <p>Every donation brings us closer to realizing the vision. Thank you for making this possible!</p>
    </div>

    <div class="social-links">
      <div class="social-bubble">
        <a href="https://twitter.com/DateClover" target="_blank" rel="noopener" class="social-icon" aria-label="Follow us on X">
          <svg class="twitter-icon" viewBox="0 0 24 24" fill="currentColor">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
        </a>
        <a href="https://github.com/Clover-Dating" target="_blank" rel="noopener" class="social-icon" aria-label="GitHub">
          <svg class="github-icon" viewBox="0 0 24 24" fill="currentColor">
            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
          </svg>
        </a>
      </div>
    </div>

    <div style="margin-top: 40px; text-align: center;">
      <span class="button-wrapper"><a href="https://givebutter.com/JdcVTE" target="_blank" rel="noopener" class="donate-button">
        <img src="heart-light.png" alt="" class="heart-icon">
        Donate
      </a></span>
    </div>

    <div style="margin-top: 24px; width: 100%; max-width: 440px; margin-left: auto; margin-right: auto;">
      <givebutter-widget id="p5k1AL" style="width: 100%;"></givebutter-widget>
    </div>

    </div>

  <footer class="footer">
    <div class="fleuron">
      <img class="fleuron-light" src="fleuron-light.png" alt="">
      <img class="fleuron-dark" src="fleuron-dark.png" alt="">
    </div>
    Clover Dating &middot; 2026 &middot; <a href="mailto:hello@clover.dating">hello@clover.dating</a>
  </footer>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // Theme handling
    const themeToggle = document.querySelector('.theme-toggle');

    // Check for saved preference or system preference
    function getPreferredTheme() {
      const saved = localStorage.getItem('theme');
      if (saved) return saved;
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    }

    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
    }

    // Initialize theme
    setTheme(getPreferredTheme());

    // Listen for system theme changes
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
      if (!localStorage.getItem('theme')) {
        setTheme(e.matches ? 'dark' : 'light');
      }
    });

    // Toggle button
    themeToggle.addEventListener('click', () => {
      const current = document.documentElement.getAttribute('data-theme');
      setTheme(current === 'dark' ? 'light' : 'dark');
    });

    // Supabase signup
    const SUPABASE_URL = 'https://pufzimcovdciuhuzosqj.supabase.co';
    const SUPABASE_PUBLISHABLE_KEY = 'sb_publishable_5jWHgF2c4zU6Q_DaaX-bmg_c6vCY-1L';

    const db = window.supabase.createClient(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY);

    const form = document.getElementById('signup-form');
    const message = document.getElementById('form-message');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('email').value;

      message.textContent = 'Signing up...';
      message.style.color = 'var(--text-secondary)';

      const { error } = await db
        .from('email_signups')
        .insert({ email });

      if (error) {
        if (error.code === '23505') {
          message.textContent = "You're already on the list!";
          message.style.color = 'var(--primary)';
        } else {
          message.textContent = 'Something went wrong. Try again?';
          message.style.color = 'var(--error)';
        }
      } else {
        message.textContent = "You're in! We'll let you know when we launch.";
        message.style.color = 'var(--primary)';
        form.reset();
      }
    });
  </script>
  <script>
  function smartenQuotes(el) {
    const walker = document.createTreeWalker(el, NodeFilter.SHOW_TEXT);
    while (walker.nextNode()) {
      const node = walker.currentNode;
      node.nodeValue = node.nodeValue
        .replace(/(^|[\s(\[{])"(\S)/g, '$1\u201c$2')  // opening double
        .replace(/(\S)"([\s.,;:!?\])}]|$)/g, '$1\u201d$2')  // closing double
        .replace(/"(\S)/g, '\u201c$1')  // fallback opening double
        .replace(/(\S)"/g, '$1\u201d')  // fallback closing double
        .replace(/(^|[\s(\[{])'(\S)/g, '$1\u2018$2')  // opening single
        .replace(/(\w)'(\w)/g, '$1\u2019$2')  // apostrophe
        .replace(/(\S)'([\s.,;:!?\])}]|$)/g, '$1\u2019$2');  // closing single
    }
  }
  smartenQuotes(document.body);
  </script>
  <script>
  // Logo shader — renders pixel art clover as WebGL with wave-flip animation
  (function() {
    var canvas = document.getElementById('logo-canvas');
    var gl = canvas.getContext('webgl', { alpha: true, premultipliedAlpha: false });

    if (!gl) {
      // Fallback to static image
      var fallback = document.createElement('img');
      fallback.src = 'logomark.png';
      fallback.alt = 'Clover';
      fallback.className = 'logo';
      canvas.replaceWith(fallback);
      return;
    }

    var dpr = window.devicePixelRatio || 1;
    canvas.width = 228 * dpr;
    canvas.height = 212 * dpr;
    canvas.style.width = '228px';
    canvas.style.height = '212px';

    var vsSource = [
      'attribute vec2 aPosition;',
      'void main() {',
      '  gl_Position = vec4(aPosition, 0.0, 1.0);',
      '}'
    ].join('\n');

    var fsSource = [
      'precision highp float;',
      'uniform sampler2D uTexture;',
      'uniform float uTime;',
      'uniform vec2 uResolution;',
      '',
      'const vec2 GRID = vec2(57.0, 53.0);',
      'const float PI = 3.14159265;',
      '',
      '// Timing',
      'const float WAVE_DURATION = 2.0;',
      'const float FLIP_DURATION = 2.0;',
      'const float NOISE_AMOUNT = 0.7;',
      'const float CYCLE_PERIOD = 5.0;',
      '',
      '// Visuals',
      'const float RAISE_SCALE = 0.0;',
      'const float SHADOW_STRENGTH = 0.1;',
      'const float BACK_BRIGHTNESS = 0.1;',
      'const float FRAC_IGNORED = 0.7;',
      '',
      'float hash21(vec2 p) {',
      '  p = fract(p * vec2(234.34, 435.345));',
      '  p += dot(p, p + 34.23);',
      '  return fract(p.x * p.y);',
      '}',
      '',
      'void main() {',
      '  float pixelScale = uResolution.x / GRID.x;',
      '  float halfPx = pixelScale * 0.5;',
      '',
      '  vec2 uv = gl_FragCoord.xy;',
      '  uv.y = uResolution.y - uv.y;',
      '',
      '  vec2 baseCell = floor(uv / pixelScale);',
      '  float animTime = mod(uTime, CYCLE_PERIOD);',
      '',
      '  float bestZ = -1.0;',
      '  vec4 bestColor = vec4(0.0);',
      '  float shadowAlpha = 0.0;',
      '',
      '  for (int dy = -2; dy <= 2; dy++) {',
      '    for (int dx = -2; dx <= 2; dx++) {',
      '      vec2 cell = baseCell + vec2(float(dx), float(dy));',
      '',
      '      if (cell.x >= 0.0 && cell.x < GRID.x && cell.y >= 0.0 && cell.y < GRID.y) {',
      '        vec4 texel = texture2D(uTexture, (cell + 0.5) / GRID);',
      '',
      '        if (texel.a >= 0.5) {',
      '          // Wave timing: bottom-left to top-right diagonal',
      '          float diagPos = (cell.x + (GRID.y - 1.0 - cell.y)) / (GRID.x + GRID.y - 2.0);',
      '          float noise = (hash21(cell) - 0.5) * NOISE_AMOUNT;',
      '          float delay = diagPos * WAVE_DURATION + noise + NOISE_AMOUNT * 0.5;',
      '          float phase = clamp((animTime - delay) / FLIP_DURATION, 0.0, 1.0);',
      '          phase *= step(FRAC_IGNORED, hash21(cell * 7.13));',
      '',
      '          // Raise: peaks at phase 0.5',
      '          float raise = sin(phase * PI);',
      '          // Full 360-degree flip so it lands back on front',
      '          float angle = phase * 2.0 * PI;',
      '          float cosA = cos(angle);',
      '          float absCos = abs(cosA);',
      '          float scale = 1.0 + raise * RAISE_SCALE;',
      '',
      '          vec2 cellCenter = (cell + 0.5) * pixelScale;',
      '          vec2 rel = uv - cellCenter;',
      '',
      '          // Shadow: offset down-right, original pixel size',
      '          vec2 sOff = vec2(1.5, 1.5) * raise * pixelScale * 0.6;',
      '          vec2 sRel = uv - (cellCenter + sOff);',
      '          if (abs(sRel.x) < halfPx && abs(sRel.y) < halfPx) {',
      '            shadowAlpha = max(shadowAlpha, raise * SHADOW_STRENGTH);',
      '          }',
      '',
      '          // Pixel: flip compresses along diagonal perpendicular to wave',
      '          if (absCos >= 0.06) {',
      '            float da = (rel.x + rel.y) * 0.7071;',
      '            float db = (rel.x - rel.y) * 0.7071 / absCos;',
      '            float ux = (da + db) * 0.7071;',
      '            float uy = (da - db) * 0.7071;',
      '            if (abs(ux) < halfPx * scale && abs(uy) < halfPx * scale && raise > bestZ) {',
      '              bestZ = raise;',
      '              float front = step(0.0, cosA);',
      '              vec3 color = mix(texel.rgb + BACK_BRIGHTNESS, texel.rgb * (1.0 + raise * 0.12), front);',
      '              bestColor = vec4(color, 1.0);',
      '            }',
      '          }',
      '        }',
      '      }',
      '    }',
      '  }',
      '',
      '  if (bestZ >= 0.0) {',
      '    gl_FragColor = bestColor;',
      '  } else if (shadowAlpha > 0.0) {',
      '    gl_FragColor = vec4(0.0, 0.0, 0.0, shadowAlpha);',
      '  } else {',
      '    gl_FragColor = vec4(0.0);',
      '  }',
      '}'
    ].join('\n');

    function createShader(type, source) {
      var shader = gl.createShader(type);
      gl.shaderSource(shader, source);
      gl.compileShader(shader);
      if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
        console.error('Shader compile error:', gl.getShaderInfoLog(shader));
        gl.deleteShader(shader);
        return null;
      }
      return shader;
    }

    var vs = createShader(gl.VERTEX_SHADER, vsSource);
    var fs = createShader(gl.FRAGMENT_SHADER, fsSource);
    if (!vs || !fs) return;

    var program = gl.createProgram();
    gl.attachShader(program, vs);
    gl.attachShader(program, fs);
    gl.linkProgram(program);

    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
      console.error('Program link error:', gl.getProgramInfoLog(program));
      return;
    }

    gl.useProgram(program);

    // Fullscreen quad
    var buf = gl.createBuffer();
    gl.bindBuffer(gl.ARRAY_BUFFER, buf);
    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1,-1, 1,-1, -1,1, 1,1]), gl.STATIC_DRAW);

    var aPos = gl.getAttribLocation(program, 'aPosition');
    gl.enableVertexAttribArray(aPos);
    gl.vertexAttribPointer(aPos, 2, gl.FLOAT, false, 0, 0);

    var uTime = gl.getUniformLocation(program, 'uTime');
    var uResolution = gl.getUniformLocation(program, 'uResolution');
    var uTextureUniform = gl.getUniformLocation(program, 'uTexture');

    // Load sprite as texture (nearest-neighbor for crisp pixels)
    var tex = gl.createTexture();
    var img = new Image();
    img.onload = function() {
      gl.bindTexture(gl.TEXTURE_2D, tex);
      gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, img);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
      startTime = performance.now() / 1000;
      requestAnimationFrame(render);
    };
    img.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAA1CAYAAAD72kP+AAAB60lEQVRoge1aO7KDMAwUTI5Hn56DpafP/UjlN45jG31W8ktgGyYTW2iRJRbZEzlh3ZY9//24PyfEWA2gxhJKpxNqzkvGagEn2XI6IXdeMtaCGWHkvyOcZIreURSRuCGM5A4/7s8JQaC0Y1m65kiWhNZt2a25VHtQlgdnItm6sYVobyVoibrlpIYoaqmXcC08EqJeBIkCqiuHqCdBIiNJbpR6RCUEtXlujqSFaARBIrCs4zgskXXl+AsdnCKSEJKSvEq5mV+5c7X+wWVdCy2pJilcGv+InGRdiSOp5k3UXQxwliRC1PfgSlKSc55E3UhqpJoXURdZZ9GiRxJQYxMu6xBiuyUBtfbCu3VE/Afxtd26XAhE3fNqSWrQi5Akz5CRdolkzUFJxfyJz6vIxjLRwA56JEJJjiBINKi6RudcGMlRUSQKIjmSIJHTTnMO761yDk6heEKwbss+csmylw5qQ3QETrFcL5K/gr+DEZZDQ9y5rbzu5XvN9pHd8vfcc5KD3lxEr8d6z3Vb9tmLoGSMZp7kNNfHOR7L6yHNRb8TtTth6Xqr/Wl1BH0GQGKrxmFYdbUeP5MEBHLsjIsywlzxblVYb5FEFSF0TlrtfUTS8mmE7J5zbHN9m1HFxjKmNg7ed/Uiys0xTS5KfH4B5OWbyyCvi/AAAAAASUVORK5CYII=';

    var INITIAL_DELAY = 2.5;
    var startTime;

    function render() {
      var elapsed = performance.now() / 1000 - startTime;
      var time = Math.max(0, elapsed - INITIAL_DELAY);

      gl.viewport(0, 0, canvas.width, canvas.height);
      gl.clearColor(0, 0, 0, 0);
      gl.clear(gl.COLOR_BUFFER_BIT);

      gl.uniform1f(uTime, time);
      gl.uniform2f(uResolution, canvas.width, canvas.height);
      gl.uniform1i(uTextureUniform, 0);

      gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
      requestAnimationFrame(render);
    }
  })();
  </script>
  <script>
  // Track visit (deduplicated, 30-min cooldown, client-side geo lookup)
  // Inserts directly via Supabase client (requires RLS INSERT policy on page_visits)
  (function() {
    var COOLDOWN = 30 * 60 * 1000;
    var last = localStorage.getItem('clover_last_visit');
    if (last && Date.now() - parseInt(last) < COOLDOWN) return;

    var ua = navigator.userAgent;
    var os = /iPhone|iPad/.test(ua) ? 'iOS' : /Mac/.test(ua) ? 'macOS' : /Android/.test(ua) ? 'Android' : /Windows/.test(ua) ? 'Windows' : /Linux/.test(ua) ? 'Linux' : 'Other';
    var browser = /Edg/.test(ua) ? 'Edge' : /Chrome/.test(ua) ? 'Chrome' : /Firefox/.test(ua) ? 'Firefox' : /Safari/.test(ua) ? 'Safari' : 'Other';

    function trackVisit(geo) {
      db.from('page_visits').insert({
        page_path: window.location.pathname || '/',
        referrer: document.referrer || null,
        platform: os + ' / ' + browser,
        city: geo ? geo.city : null,
        region: geo ? geo.region : null,
        country: geo ? geo.country : null,
        country_code: geo ? geo.country_code : null,
        postal: geo ? geo.postal : null
      }).then(function() {});
    }

    // Geo lookup from browser (sees visitor's real IP, no shared rate limits)
    fetch('https://ipwho.is/').then(function(r) { return r.json(); }).then(function(geo) {
      trackVisit(geo.success ? geo : null);
    }).catch(function() {
      trackVisit(null);
    });

    localStorage.setItem('clover_last_visit', Date.now().toString());
  })();
  </script>
</body>
</html>
